# 浏览器显示内容的流程（client -> server -> client）
## 1. 输入域名 www.xxx.com
## 2. 域名解析
- 查找浏览器缓存。  浏览器会缓存DNS，但保存时间不长。
- 查找系统缓存。    浏览器缓存没有IP,就会进行系统调用，查找本地hosts文件。
- 查找路由缓存。    从路由器中查找DNS缓存。这些是由ISP服务商缓存DNS的服务器。
- 递归查询。        ISP服务器会递归查询，本地域名服务器会以DNS客户的身份，向根域名服务器发送查询请求。（本地域名服务器地址通过DHPC协议获取地址，DHCP负责分配IP地址）
- 迭代查询。        本地域名服务器向根域名服务器查询，根域名服务器返回下一步应该查询哪个域名服务器，本地域名服务器就自己再去查询。
## 3. 浏览器和服务器建立TCP连接
- TCP 三次握手
    - 客户端发送请求连接报文（syn = 1)
    - 服务器接收后同意建立连接，返回一个确认报文(syn = 1, ack = 1)
    - 客户端收到确认报文后返回一个确认报文
    - TPC连接建立完成
## 4. 浏览器通过http协议发送请求
- 浏览器向服务器发送HTTP-Get请求，其中包含：
    - URL（http://www.xxx.com）
    - KeepAlive 长连接
    - User-Agent 提供浏览器，操作系统，编码等信息
    - Accept-encode 采用gzip压缩传输html文件
    - Cookie 首次访问，会提示服务器建立用户缓存。如果不是首次访问，会利用coocies对应的key找到缓存，其中存放用户名，密码，用户配置等信息
## 5. 有些服务器会做重定向响应
- 有些大型网站可能存在多个主机站点，他们往往返回的不是200ok的状态码，而是301，302等以3开头的重定向状态码。浏览器收到这些重定向响应后会在响应中`location`中找到重定向地址，并重新访问
- 重定向是为了负载均衡或者导入流量（提高SEO排名）。将不同区域的请求均衡到各地主机，主要是为了提高网站的并发量。

## 6.服务器处理请求
## 7. 服务器发起HTML响应
## 8.释放TCP连接
- 浏览器向服务器发送连接释放报文，并停止发送数据
- 服务器收到释放报文后返回一个确认报文，并将未传送完的数据传送完
- 传送完毕后，向客户端发送释放报文
- 客户端收到报文后，发送确认报文，并等待一段时间后，释放TCP连接
## 9.浏览器显示页面
浏览器还没有完整接受全部的HTML文档时就开始显示页面，浏览器接收到返回的数据包，根据自己的渲染机制进行渲染。接着进行相应的页面呈现和脚本交互
## 10.浏览器发送获取HTML中的其他内容
HTML中可能会存在一些样式文件，图片，js文件等等，这些内容会通过url呈现，浏览器会通过这些url继续发送请求，请求过程和上述相同。这些静态文件可以缓存在浏览器中，下次访问可以直接从缓存中读取。
